= 결측값 처리

결측값 처리(Missing Data Handling)는 데이터 전처리에서 매우 중요한 부분으로, 결측값이 포함된 데이터를 그대로 사용하면 모델의 성능이 저하되거나, 분석이 왜곡될 수 있습니다. 결측값 처리의 목표는 데이터를 분석할 수 있도록 결측값을 적절히 처리하는 것입니다.

결측값 처리 방법은 크게 삭제, 대체, 예측, 모델 기반 방법 등으로 나눌 수 있습니다. 

1. 결측값 삭제 (Deletion) +
결측값이 포함된 데이터를 삭제하는 방법은 가장 직관적인 처리 방법이지만, 결측값이 많을 경우 데이터 손실이 클 수 있습니다.
* 행 삭제 (Row Deletion) +
결측값이 포함된 행을 삭제하는 방법입니다.
** 장점: 처리 방법이 간단하고 빠릅니다.
** 단점: 결측값이 많을 경우 데이터 손실이 커지고, 분석 결과에 왜곡을 가져올 수 있습니다.
** 적용 시기: 결측값이 일부에 불과하거나, 결측값이 포함된 행이 분석에 중요한 영향을 미치지 않는 경우 사용합니다.
* 열 삭제 (Column Deletion) +
결측값이 포함된 열을 삭제하는 방법입니다.
** 장점: 분석에 큰 영향을 미치지 않는 경우 유용할 수 있습니다.
** 단점: 중요한 특성을 가진 열까지 삭제될 위험이 있습니다.
** 적용 시기: 해당 열의 결측값이 많거나 해당 열이 분석에 중요하지 않을 경우 사용합니다.
2. 결측값 대체 (Imputation) +
결측값을 다른 값으로 대체하는 방법입니다. 대체 값으로는 평균, 중앙값, 최빈값 등을 사용할 수 있습니다. 이 방법은 데이터 손실을 줄이고, 모델 학습에 필요한 데이터를 유지할 수 있습니다.
* 평균값 대체 (Mean Imputation) +
결측값이 있는 특성의 평균값을 대체값으로 사용하는 방법입니다.
** 장점: 간단하고 계산이 빠릅니다.
** 단점: 평균으로 대체하면 데이터의 분산이 감소하고, 이상치의 영향을 받을 수 있습니다. 특히 비정규 분포일 경우 문제가 될 수 있습니다.
** 적용 시기: 데이터가 정규 분포를 따르거나, 결측값이 적은 경우 사용합니다.
* 중앙값 대체 (Median Imputation) +
결측값을 해당 특성의 중앙값으로 대체하는 방법입니다.
** 장점: 이상치에 덜 민감하며, 중앙값은 데이터 분포의 중심을 반영하므로 더 안정적일 수 있습니다.
** 단점: 평균값 대체보다는 덜 직관적이고, 분포를 반영하기 어려운 경우가 있을 수 있습니다.
** 적용 시기: 데이터가 비정규 분포를 따르거나, 이상치가 있을 때 사용합니다.
* 최빈값 대체 (Mode Imputation): 결측값을 범주형 데이터의 최빈값(가장 많이 등장하는 값)으로 대체하는 방법입니다.
** 장점: 범주형 변수에 적합하고, 결측값을 채우기 쉽게 사용할 수 있습니다.
** 단점: 데이터의 다양성을 반영하지 않기 때문에 분석 결과에 영향을 미칠 수 있습니다.
** 적용 시기: 범주형 데이터에 주로 사용됩니다.
* 선형 회귀 기반 대체 +
결측값을 예측하는 데 선형 회귀 모델을 사용하는 방법입니다. 다른 변수들이 결측값을 예측하는 데 사용됩니다.
** 장점: 변수 간의 관계를 반영하여 결측값을 대체할 수 있습니다.
** 단점: 회귀 모델을 학습시킬 때, 결측값이 포함된 데이터로부터 학습을 해야 하므로 계산 비용이 증가합니다.
3. 결측값 예측 (Predictive Modeling) +
결측값을 예측하는 모델을 구축하여, 결측값을 채우는 방법입니다. 예측 모델은 결측값을 다른 값으로 대체하는 것이 아니라, 결측값을 예측하기 위한 별도의 모델을 학습하여 값을 추정합니다.
* k-최근접 이웃 (K-Nearest Neighbors, KNN) + 
KNN 알고리즘을 사용하여 결측값을 채우는 방법입니다. 결측값이 있는 샘플과 유사한 다른 샘플들의 평균값을 사용하여 대체합니다.
** 장점: 유사한 데이터를 기반으로 대체하기 때문에 좀 더 정교한 예측이 가능합니다.
** 단점: KNN은 계산 비용이 많이 들며, 데이터가 많을 경우 비효율적일 수 있습니다.
* 기계 학습 모델 +
랜덤 포레스트, 서포트 벡터 머신(SVM) 등 다양한 기계 학습 모델을 사용하여 결측값을 예측할 수 있습니다. 학습할 때 결측값을 제외한 나머지 데이터로 모델을 훈련시킨 후, 결측값을 예측합니다.
** 장점: 데이터 간의 복잡한 관계를 반영하여 예측할 수 있습니다.
** 단점: 모델을 학습시키는 데 시간이 걸리고, 계산 비용이 높을 수 있습니다.
4. 다중 대체법 (Multiple Imputation) +
다중 대체법은 결측값을 한 번만 대체하는 것이 아니라 여러 번 대체하여 불확실성을 반영하는 방법입니다. 여러 개의 예측된 값으로 여러 개의 데이터셋을 생성한 후, 각 데이터셋에 대해 분석을 수행하고 결과를 통합하여 최종 결정을 내립니다.
* 장점: 결측값을 하나의 값으로만 대체하는 것보다 더 신뢰할 수 있는 결과를 얻을 수 있습니다.
* 단점: 복잡한 방법이므로 계산량이 많고, 이해하기 어렵습니다.
5. 결측값 대체 방법 선택 기준 +
결측값 처리 방법을 선택할 때는 다음과 같은 기준을 고려해야 합니다.
** 결측값의 비율: 결측값이 많을수록 대체 방법을 신중하게 선택해야 합니다. 너무 많은 결측값을 삭제하면 데이터 손실이 커질 수 있습니다.
** 데이터의 분포: 데이터가 정규 분포를 따르는지, 이상치가 있는지 등을 고려하여 평균값, 중앙값 또는 다른 방법을 선택합니다.
** 데이터의 특성: 범주형 변수인지 수치형 변수인지, 시간에 따른 순차적 관계가 있는지 등에 따라 적절한 처리 방법이 달라집니다.
** 모델의 복잡성: 대체 방법이 복잡할수록 계산 시간이 증가하므로, 데이터의 크기와 모델의 복잡성을 고려해야 합니다.

결측값 처리는 데이터 분석 및 모델링에서 중요한 과정입니다. 각 방법은 데이터의 특성, 결측값의 비율, 분석 목적에 따라 다르게 선택할 수 있습니다. 적절한 결측값 처리 방법을 선택하는 것이 모델 성능을 높이고, 분석 결과의 신뢰성을 확보하는 데 중요한 역할을 합니다.