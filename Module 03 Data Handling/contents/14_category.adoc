=  범주형 데이터 처리

범주형 데이터 처리는 머신러닝 및 데이터 분석에서 중요한 단계입니다. 범주형 데이터는 고유한 값들이 **구별된 범주(category)**를 형성하는 데이터로, 숫자나 연속적인 값이 아닌, 이산적인 값으로 구성됩니다. 예를 들어, "성별" (남성, 여성), "지역" (서울, 부산, 대구)와 같은 변수들이 범주형 데이터에 해당합니다.

범주형 데이터를 잘 처리하는 것은 모델의 성능을 개선하는 데 중요합니다. 머신러닝 모델은 숫자 데이터를 선호하기 때문에, 범주형 데이터를 적절히 변환하여 모델에 맞는 형태로 변환해야 합니다.

1. 범주형 데이터의 특징
* 명목형 (Nominal) +
범주 간 순서나 크기가 없는 데이터입니다. 예를 들어, "성별" (남성, 여성), "국가" (한국, 미국, 일본)와 같은 변수들이 이에 해당합니다.
* 순서형 (Ordinal) +
범주 간 순서가 있지만, 그 차이가 일정하지 않은 데이터입니다. 예를 들어, "고객 만족도" (매우 불만족, 불만족, 보통, 만족, 매우 만족)와 같은 변수들이 이에 해당합니다.
2. 범주형 데이터 처리 기법 +
범주형 데이터를 처리하는 방법은 크게 인코딩(Encoding) 기법과 데이터의 차원 축소 또는 특성 확장 방법으로 나눌 수 있습니다.
a. 레이블 인코딩 (Label Encoding)
레이블 인코딩은 각 범주를 고유한 숫자로 변환하는 방법입니다. 예를 들어, "성별"이라는 변수에서 "남성"을 0으로, "여성"을 1로 변환하는 방식입니다.
* 장점: 간단하고, 데이터가 적은 경우 효율적입니다.
* 단점: 순서가 없는 명목형 변수에 레이블 인코딩을 적용하면, 모델이 이 숫자들 간에 순서가 있다는 잘못된 가정을 할 수 있습니다. 예를 들어, "서울", "부산", "대구"와 같은 지역 데이터에서 숫자화하면 모델이 1 < 2 < 3으로 해석할 수 있습니다.
* 적용 시기: 순서가 의미가 없는 범주형 데이터 (예: "성별", "국가")를 처리할 때 사용됩니다.
b. 원-핫 인코딩 (One-Hot Encoding) +
원-핫 인코딩은 범주형 변수를 각 범주별로 이진 변수로 변환하는 방법입니다. 즉, 각 범주를 하나의 새로운 열로 변환하여, 해당 범주가 해당하는 경우 1, 아니면 0으로 표시합니다.
+
예를 들어, "색상"이라는 변수에 "빨간색", "파란색", "녹색"이 있다면, 원-핫 인코딩을 적용한 결과는 다음과 같습니다:
+
[%header, cols="4", width=50%]
|===
|색상|빨간색|파란색|녹색
|빨간색|1|0|0
|파란색|0|1|0
|녹색|0|0|1
|===
+
* 장점: 범주 간 순서나 관계가 없는 명목형 데이터를 처리할 때 유용합니다. 모델이 각 범주를 독립적인 변수로 인식할 수 있습니다.
* 단점: 범주가 많을 경우 열의 수가 크게 증가하여 차원의 저주(Curse of Dimensionality) 문제가 발생할 수 있습니다. 이로 인해 모델 학습 속도가 느려지고, 과적합(overfitting)의 위험이 커질 수 있습니다.
* 적용 시기: 범주형 변수가 순서가 없고, 범주의 수가 적당할 때 주로 사용됩니다.
c. 임베딩 (Embedding) +
임베딩은 범주형 데이터를 연속적인 고차원 벡터로 변환하는 방법입니다. 특히 딥러닝에서 자주 사용됩니다. 예를 들어, "국가"라는 변수에 대해 각 국가를 고차원의 벡터로 변환하여 모델에 입력하는 방식입니다.
* 장점: 고차원 범주형 변수를 처리할 때 유용하고, 차원의 폭발을 피할 수 있습니다.
* 단점: 주로 신경망 모델에서만 사용되며, 모델 학습이 복잡하고 시간이 오래 걸릴 수 있습니다.
* 적용 시기: 범주형 데이터가 매우 많을 때, 특히 딥러닝 모델에서 효과적입니다.
d. 주요 빈도 인코딩 (Frequency Encoding) +
주요 빈도 인코딩은 각 범주를 해당 범주가 데이터셋에서 등장하는 빈도로 변환하는 방법입니다. 예를 들어, "성별"이라는 변수에서 "남성"이 200번 등장하고 "여성"이 100번 등장했다면, 이를 각각 200과 100으로 변환합니다.
* 장점: 차원 수를 늘리지 않으며, 범주의 빈도를 반영할 수 있어 효율적입니다.
* 단점: 빈도가 적은 범주에 대해서는 잘못된 정보를 제공할 수 있습니다. 또한, 모델이 빈도 정보만을 지나치게 반영할 수 있습니다.
* 적용 시기: 범주형 변수에 대해 고유한 의미를 부여하고, 변수의 빈도를 모델에 반영하고 싶을 때 사용됩니다.
e. 타겟 인코딩 (Target Encoding) +
타겟 인코딩은 범주형 변수의 각 범주에 대해 타겟 변수의 평균을 계산하여 해당 범주를 숫자로 변환하는 방법입니다. 예를 들어, "지역"에 대해 "매출"의 평균을 계산하여, 각 지역을 매출의 평균값으로 인코딩하는 방식입니다.
* 장점: 범주형 변수와 타겟 변수 간의 관계를 반영할 수 있으며, 모델의 성능을 개선할 수 있습니다.
* 단점: 과적합(overfitting)을 초래할 수 있으므로, 교차 검증 등을 통해 이를 방지해야 합니다.
* 적용 시기: 타겟 변수와 범주형 변수 간에 강한 상관 관계가 있을 때 유용합니다.

3. 범주형 데이터 처리 시 고려할 점 +
범주형 데이터를 처리할 때는 몇 가지 중요한 요소를 고려해야 합니다:
* 범주의 수: 범주가 많은 경우, 원-핫 인코딩은 차원의 폭발 문제를 일으킬 수 있으므로 다른 방법(예: 타겟 인코딩, 빈도 인코딩)을 고려할 수 있습니다.
* 데이터의 순서 여부: 순서형 데이터의 경우, 레이블 인코딩을 사용하거나, 순서 정보를 반영한 인코딩 방법을 사용할 수 있습니다.
* 모델의 요구 사항: 사용하는 머신러닝 모델의 종류에 따라 범주형 데이터 처리 방식이 달라질 수 있습니다. 예를 들어, 트리 기반 모델은 원-핫 인코딩 없이도 범주형 변수를 처리할 수 있습니다.

범주형 데이터를 처리하는 방법은 데이터의 특성, 범주의 수, 모델의 요구 사항에 따라 달라집니다. 올바른 인코딩 방법을 선택하는 것은 모델 성능에 중요한 영향을 미치므로, 다양한 방법을 시도하고 평가하여 최적의 방법을 선택하는 것이 중요합니다.