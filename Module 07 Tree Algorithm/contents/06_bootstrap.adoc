= 부트스트랩(Bootstrap)

머신러닝에서 **부트스트랩(Bootstrap)**은 통계학에서 유래한 데이터 샘플링 기법으로, 주어진 데이터를 사용하여 추정과 평가를 수행하는 데 사용됩니다. 머신러닝에서는 주로 모델의 성능을 평가하거나 불확실성을 측정하는 데 활용됩니다.

== 부트스트랩의 개념

부트스트랩은 재표본추출(resampling) 기법 중 하나로, 주어진 데이터에서 복원 추출(replacement sampling)을 통해 여러 개의 새로운 샘플 데이터를 생성합니다. 이 새로운 샘플을 기반으로 다양한 통계적 분석이나 모델 훈련을 수행합니다.

== 주요 특징

1. 복원 추출
* 주어진 데이터셋에서 각 샘플을 뽑은 후 복원하므로, 같은 데이터 포인트가 여러 번 포함될 수 있습니다.
* 생성된 샘플의 크기는 원래 데이터셋과 동일하게 유지됩니다.
2. 샘플링의 반복
* 데이터를 여러 번 샘플링하여 다양한 데이터셋을 생성합니다. 이 과정은 통계적으로 유의미한 결과를 도출하는 데 도움을 줍니다.

== 부트스트랩의 주요 용도
1. 모델 성능 평가
* 머신러닝 모델의 성능(예: 정확도, F1 점수 등)을 안정적으로 평가하기 위해 사용됩니다.
* 여러 개의 부트스트랩 샘플에 대해 모델을 훈련하고 평가한 뒤, 결과를 평균 및 분산으로 요약하여 성능의 신뢰 구간을 제공합니다.
2. 신뢰 구간 추정
* 특정 통계량(예: 평균, 분산, 회귀 계수 등)의 신뢰 구간을 추정하는 데 활용됩니다.
* 원본 데이터에서 부트스트랩 샘플을 생성하고 각 샘플에서 통계량을 계산한 뒤, 분포를 분석하여 신뢰 구간을 계산합니다.
3. 오버피팅 방지
* 부트스트랩 기법을 통해 다양한 샘플에서 모델을 평가함으로써, 모델이 특정 데이터셋에 지나치게 적합하는 것을 방지할 수 있습니다.

== 머신러닝에서의 부트스트랩 과정

1. 원본 데이터 준비
* 크기가 𝑁N인 데이터셋 𝐷D가 주어짐.
2. 부트스트랩 샘플 생성
* 𝐷D에서 복원 추출을 통해 크기가 𝑁인 샘플 𝐷~1~,𝐷~2~,…,𝐷~𝐵~ 를 생성.(𝐵B는 반복 횟수)
3. 모델 훈련 및 평가
* 각 부트스트랩 샘플 𝐷~𝑖~ 에 대해 모델을 학습.
* 테스트 데이터나 OOB 데이터(Out-of-Bag 데이터)를 사용해 평가.
4. 평가 결과 통합
* 𝐵개의 모델 성능 측정치를 평균 내거나 신뢰 구간을 계산.

== 장점

* 작은 데이터셋에도 유용 +
원본 데이터셋이 작아도 신뢰 구간을 추정하거나 모델 성능을 평가할 수 있음.
* 통계적 유연성 +
데이터의 분포에 대한 강한 가정을 하지 않아도 됨.
* 불확실성 평가 가능 +
모델의 예측 성능에 대한 신뢰도를 정량화할 수 있음.

== 단점
* 계산 비용 +
부트스트랩 샘플 수가 많아지면 계산량이 증가함.
* 대표성 문제 +
작은 데이터셋에서는 샘플링 편향이 발생할 가능성이 있음.
* 중복 데이터 문제  +
복원 추출로 인해 일부 데이터 포인트가 과도하게 사용될 수 있음.

== 예제 (파이썬)
다음은 부트스트랩을 사용하여 평균의 신뢰 구간을 계산하는 간단한 예제입니다:

[source, python]
----
import numpy as np

# 원본 데이터셋
data = np.array([10, 20, 30, 40, 50])

# 부트스트랩 샘플링
B = 1000  # 부트스트랩 반복 횟수
means = []

for _ in range(B):
    sample = np.random.choice(data, size=len(data), replace=True)  # 복원 추출
    means.append(np.mean(sample))

# 신뢰 구간 계산
lower_bound = np.percentile(means, 2.5)
upper_bound = np.percentile(means, 97.5)

print(f"평균의 95% 신뢰 구간: ({lower_bound}, {upper_bound})")
----

코드는 데이터셋의 평균에 대한 신뢰 구간을 추정합니다. 머신러닝 모델의 평가에도 이와 유사한 방법을 적용할 수 있습니다.

== 부트스트랩 vs 교차 검증
* 부트스트랩은 데이터를 복원 추출하여 새로운 샘플을 생성하고 이를 기반으로 평가.
* 교차 검증은 데이터를 비복원 방식으로 분할하여 평가.

두 방법은 모델 평가 및 검증에서 서로 보완적으로 사용될 수 있습니다.